<div class="container form-container mt-5">
  <div class="row justify-content-center">
    <div class="col-md-8 col-lg-6">
      <form [formGroup]="form" (ngSubmit)="onEnviar($event)" novalidate>
        <h2 class="mb-4 text-center">Crear cuenta</h2>

        <!-- Nombre -->
        <div class="mb-3">
          <label for="InputName" class="form-label">Nombre <span style="color: red">*</span></label>
          <input
            type="text"
            formControlName="first_name"
            class="form-control"
            id="InputName"
            aria-label="Nombre"
            required
            [attr.aria-invalid]="FirstName?.invalid && (FirstName?.dirty || FirstName?.touched)"
            aria-describedby="nameHelp"
          />
          <div *ngIf="FirstName?.errors && (FirstName?.dirty || FirstName?.touched)" id="nameHelp" class="text-danger" role="alert">
            <div *ngIf="FirstName?.hasError('required')">El nombre es obligatorio.</div>
          </div>
        </div>
        <!-- Apellido -->
        <div class="mb-3">
          <label for="InputLastName" class="form-label">Apellido <span style="color: red">*</span></label>
          <input
            type="text"
            formControlName="last_name"
            class="form-control"
            id="InputLastName"
            aria-label="Apellido"
            required
            [attr.aria-invalid]="LastName?.invalid && (LastName?.dirty || LastName?.touched)"
            aria-describedby="lastNameHelp"
          />
          <div *ngIf="LastName?.errors && (LastName?.dirty || LastName?.touched)" id="lastNameHelp" class="text-danger" role="alert">
            <div *ngIf="LastName?.hasError('required')">El apellido es obligatorio.</div>
          </div>
        </div>
        <!-- DNI -->
        <div class="mb-3">
          <label for="InputDNI" class="form-label">DNI <span style="color: red">*</span></label>
          <input
            type="text"
            formControlName="dni"
            class="form-control"
            id="InputDNI"
            aria-label="DNI"
            required
            pattern="^\d{6,10}$"
            [attr.aria-invalid]="dni?.invalid && (dni?.dirty || dni?.touched)"
            aria-describedby="dniHelp"
          />
          <div *ngIf="dni?.errors && (dni?.dirty || dni?.touched)" id="dniHelp" class="text-danger" role="alert">
            <div *ngIf="dni?.hasError('required')">El DNI es obligatorio.</div>
            <div *ngIf="dni?.hasError('pattern')">Debe tener entre 6 y 10 dígitos numéricos.</div>
          </div>
        </div>

        <!-- Email -->
        <div class="mb-3">
          <label for="InputEmail" class="form-label">Correo electrónico <span style="color: red">*</span></label>
          <input
            type="email"
            formControlName="email"
            class="form-control"
            id="InputEmail"
            aria-label="Correo electrónico"
            required
            [attr.aria-invalid]="Email?.invalid && (Email?.dirty || Email?.touched)"
            aria-describedby="emailHelp"
          />
          <div *ngIf="Email?.errors && (Email?.dirty || Email?.touched)" id="emailHelp" class="text-danger" role="alert">
            <div *ngIf="Email?.hasError('required')">El correo es obligatorio.</div>
            <div *ngIf="Email?.hasError('email')">Ingrese un correo válido.</div>
          </div>
        </div>

        <!-- Usuario -->
        <div class="mb-3">
          <label for="InputUsername" class="form-label">Usuario <span style="color: red">*</span></label>
          <input
            type="text"
            formControlName="username"
            class="form-control"
            id="InputUsername"
            aria-label="Usuario"
            required
            minlength="4"
            maxlength="20"
            [attr.aria-invalid]="Username?.invalid && (Username?.dirty || Username?.touched)"
            aria-describedby="usernameHelp"
          />
          <div *ngIf="Username?.errors && (Username?.dirty || Username?.touched)" id="usernameHelp" class="text-danger" role="alert">
            <div *ngIf="Username?.hasError('required')">El usuario es obligatorio.</div>
            <div *ngIf="Username?.hasError('minlength')">Debe tener al menos 4 caracteres.</div>
            <div *ngIf="Username?.hasError('maxlength')">No puede exceder los 20 caracteres.</div>
          </div>
        </div>


        <!-- Contraseña -->
        <div class="mb-3">
          <label for="InputPassword" class="form-label">Contraseña</label>
          <div class="input-group">
            <input
              [type]="showPassword ? 'text' : 'password'"
              formControlName="password"
              class="form-control"
              id="InputPassword"
              aria-label="Contraseña"
              required
              minlength="8"
              maxlength="32"
              [attr.aria-invalid]="Password?.invalid && (Password?.dirty || Password?.touched)"
              aria-describedby="passwordHelp"
              autocomplete="new-password"
            />
            <button
              type="button"
              class="btn btn-outline-secondary"
              (click)="showPassword = !showPassword"
              [attr.aria-label]="showPassword ? 'Ocultar contraseña' : 'Mostrar contraseña'"
              tabindex="0"
            >
              <img
                *ngIf="showPassword"
                src="assets/images/icons/visibility_off_24dp_1A1A1A.svg"
                alt="Ocultar contraseña"
                width="28"
                height="28"
                aria-hidden="true"
                class="eye-icon"
                draggable="false"
                focusable="false"
              />
              <img
                *ngIf="!showPassword"
                src="assets/images/icons/visibility_24dp_1A1A1A.svg"
                alt="Mostrar contraseña"
                width="28"
                height="28"
                aria-hidden="true"
                class="eye-icon"
                draggable="false"
                focusable="false"
              />
            </button>
          </div>
          <div *ngIf="Password?.errors && (Password?.dirty || Password?.touched)" id="passwordHelp" class="text-danger" role="alert">
            <div *ngIf="Password?.hasError('required')">La contraseña es obligatoria.</div>
            <div *ngIf="Password?.hasError('minlength')">Debe tener al menos 8 caracteres.</div>
          </div>
        </div>

        <!-- Confirmar contraseña -->
        <div class="mb-3">
          <label for="InputConfirmPassword" class="form-label">Confirmar contraseña</label>
          <div class="input-group">
            <input
              [type]="showConfirmPassword ? 'text' : 'password'"
              formControlName="confirmpass"
              class="form-control"
              id="InputConfirmPassword"
              aria-label="Confirmar contraseña"
              required
              minlength="8"
              maxlength="32"
              [attr.aria-invalid]="ConfirmPass?.invalid && (ConfirmPass?.dirty || ConfirmPass?.touched)"
              aria-describedby="confirmPasswordHelp"
              autocomplete="new-password"
            />
            <button
              type="button"
              class="btn btn-outline-secondary"
              (click)="showConfirmPassword = !showConfirmPassword"
              [attr.aria-label]="showConfirmPassword ? 'Ocultar contraseña' : 'Mostrar contraseña'"
              tabindex="0"
            >
              <img
                *ngIf="showConfirmPassword"
                src="assets/images/icons/visibility_off_24dp_1A1A1A.svg"
                alt="Ocultar contraseña"
                width="28"
                height="28"
                aria-hidden="true"
                class="eye-icon"
                draggable="false"
                focusable="false"
              />
              <img
                *ngIf="!showConfirmPassword"
                src="assets/images/icons/visibility_24dp_1A1A1A.svg"
                alt="Mostrar contraseña"
                width="28"
                height="28"
                aria-hidden="true"
                class="eye-icon"
                draggable="false"
                focusable="false"
              />
            </button>
          </div>
          <div *ngIf="ConfirmPass?.errors && (ConfirmPass?.dirty || ConfirmPass?.touched)" id="confirmPasswordHelp" class="text-danger" role="alert">
            <div *ngIf="ConfirmPass?.hasError('required')">La confirmación es obligatoria.</div>
            <div *ngIf="ConfirmPass?.hasError('minlength')">Debe tener al menos 8 caracteres.</div>
          </div>
          <div *ngIf="(ConfirmPass?.dirty || ConfirmPass?.touched || Password?.dirty || Password?.touched) && form.errors?.['notSame']" id="confirmPasswordHelp" class="text-danger" role="alert">
            Las contraseñas no coinciden.
          </div>
        </div>

        <button type="submit" class="btn btn-primary w-100" [disabled]="form.invalid">Crear cuenta</button>

        <div class="mt-3 text-center">
          <a routerLink="/login" aria-label="Volver a iniciar sesión">¿Ya tienes cuenta? Inicia sesión</a>
        </div>
      </form>
    </div>
  </div>
</div>